language: c

notifications:
  email: false

# Blacklist
branches:
#  only:
#    - master
  except:
    - /^*-v[0-9]/

# Environment variables
#env:
#  global:
#    - GH_REPO_NAME: tModLoader
#    - DOXYFILE: $TRAVIS_BUILD_DIR/solutions/documentation/Doxyfile
#    - GH_REPO_REF: github.com/bluemagic123/tModLoader.git
     
# all runs, check latest, abort
# 1st run will generate tag
# 2nd run will download, deploy

# Build your code e.g. by calling make
script:
  - pwd
  - ls
  - git tag
  - git config --global user.email "builds@travis-ci.com"
  - git config --global user.name "Travis CI"
  - export GIT_TAG=v0.1.1.6.1
  - git tag $GIT_TAG -a -m "TravisCI Autogenerated Tag"
  - git push --quiet https://$GH_REPO_TOKEN@github.com/JavidPack/BossChecklist $GIT_TAG > /dev/null 2>&1
  
#  - download mod, check latest version
# return non zero to fail
before_deploy:
  - wget http://javid.ddns.net/tModLoader/download.php?Down=mods/BossChecklist.tmod
  - ls
  
# Generate and deploy documentation
after_success:
  # CREATE GIT TAG
#  - git config --global user.email "builds@travis-ci.com"
#  - git config --global user.name "Travis CI"
#  - export GIT_TAG=v0.1.1.6.1
#  - echo -n $GIT_TAG > public/version
#  - git commit -m "Set build VERSION number" public/version
#  - git tag $GIT_TAG -a -m "TravisCI Autogenerated Tag"
#  - git push --quiet https://$GH_REPO_TOKEN@github.com/JavidPack/BossChecklist $GIT_TAG > /dev/null 2>&1



deploy:
  provider: releases
  api_key: $GH_REPO_TOKEN
  file: "BossChecklist.tmod"
  skip_cleanup: true
  on:
    tags: true